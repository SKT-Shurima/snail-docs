import{_ as s,c as n,o as a,a as l}from"./app.6d7cf6a0.js";const A=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"Nginx/\u6307\u4EE4\u53CA\u57FA\u672C\u4ECB\u7ECD.md","lastUpdated":1632912264000}'),p={name:"Nginx/\u6307\u4EE4\u53CA\u57FA\u672C\u4ECB\u7ECD.md"},e=l(`<h3 id="nginx-\u547D\u4EE4" tabindex="-1">Nginx \u547D\u4EE4\uFF1A <a class="header-anchor" href="#nginx-\u547D\u4EE4" aria-hidden="true">#</a></h3><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#89DDFF;">nginx</span><span style="color:#A6ACCD;"> -t  // \u67E5\u770BNginx\u670D\u52A1\u5668\u914D\u7F6E\u6587\u4EF6\u662F\u5426\u6709\u8BED\u6CD5\u9519\u8BEF</span></span>
<span class="line"></span></code></pre></div><h3 id="nginx-conf-\u539F\u59CB\u914D\u7F6E\u6587\u4EF6" tabindex="-1">Nginx.conf \u539F\u59CB\u914D\u7F6E\u6587\u4EF6 <a class="header-anchor" href="#nginx-conf-\u539F\u59CB\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a></h3><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># nginx.conf \u539F\u59CB\u6587\u4EF6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># ******* \u5168\u5C40\u5757 start ********</span></span>
<span class="line"><span style="color:#676E95;"># \u53EA\u6709\u88AB\u8BBE\u7F6E\u7684\u7528\u6237\u7EC4\u6210\u5458\u624D\u6709\u6743\u9650\u542F\u52A8Nginx\u8FDB\u7A0B</span></span>
<span class="line"><span style="color:#676E95;"># user nobody</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u5168\u5C40\u751F\u6548\uFF0C\u914D\u7F6E\u5141\u8BB8 Nginx \u8FDB\u7A0B\u751F\u6210\u7684 worker_process \u6570\u91CF</span></span>
<span class="line"><span style="color:#89DDFF;">worker_processes </span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u914D\u7F6E Nginx \u670D\u52A1\u5668\u8FD0\u884C\u5BF9\u9519\u8BEF\u65E5\u5FD7\u5B58\u653E\u7684\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#676E95;"># error_log logs/error.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u914D\u7F6E Nginx \u8FD0\u884C\u65F6\uFF0Cpid \u6587\u4EF6\u5B58\u653E\u8DEF\u5F84\u548C\u540D\u79F0\uFF1B</span></span>
<span class="line"><span style="color:#676E95;"># pid nginx.pid</span></span>
<span class="line"><span style="color:#676E95;"># ******* \u5168\u5C40\u5757 end ********</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># ******* events start ********</span></span>
<span class="line"><span style="color:#C792EA;">events</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#676E95;"># \u914D\u7F6E\u4E8B\u4EF6\u9A71\u52A8\u6A21\u578B</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#676E95;"># use epoll;</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#676E95;"># \u5728events\u90E8\u5206\u4E2D\u751F\u6548</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> worker_connections </span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#676E95;"># ******* events end ********</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># ******* http start ********</span></span>
<span class="line"><span style="color:#C792EA;">http</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;"> 		</span><span style="color:#676E95;"># \u4EE5\u4E0B\u6307\u4EE4\u5728http\u7684server\u90E8\u5206\u4E2D\u751F\u6548</span></span>
<span class="line"><span style="color:#A6ACCD;"> 		</span><span style="color:#676E95;"># \u5B9A\u4E49 MIME-Type</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> include </span><span style="color:#A6ACCD;">      mime.types</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">   </span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> default_type </span><span style="color:#A6ACCD;"> application/octet-stream</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># \u914D\u7F6E\u5141\u8BB8\u4F7F\u7528sendfile \u65B9\u5F0F\u4F20\u8F93</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> sendfile </span><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;"> on;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># \u914D\u7F6E\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> keepalive_timeout </span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">65</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># \u914D\u7F6E\u8BF7\u6C42\u5904\u7406\u65E5\u5FD7\u7684\u683C\u5F0F</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># log_format access.log &#39;$remote_addr-[$time_local]-&quot;$request&quot;-&quot;$http_user_agent&quot;&#39;;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># \u8BF7\u6C42\u884C+\u8BF7\u6C42\u5934\u7684\u6807\u51C6\u5927\u5C0F\u4E3A1k</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># client_header_buffer_size 1k;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># \u8BF7\u6C42\u884C+\u8BF7\u6C42\u5934\u7684\u6700\u5927\u5927\u5C0F\u4E3A2k</span></span>
<span class="line"><span style="color:#A6ACCD;">	  </span><span style="color:#676E95;"># large_client_header_buffers 2 1k;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># ******* server start ********</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">server</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">    		</span><span style="color:#676E95;"># \u914D\u7F6E\u76D1\u542C\u7AEF\u53E3\u548C\u4E3B\u673A\u540D\u79F0\uFF08\u57FA\u4E8E\u540D\u79F0\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> listen </span><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">8080</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> server_name </span><span style="color:#A6ACCD;"> localhost</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;"># \u914D\u7F6E\u8BF7\u6C42\u5904\u7406\u65E5\u5FD7\u5B58\u653E\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;"># access_log /myweb/server1/log/access.log</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">/ </span><span style="color:#A6ACCD;">{            </span><span style="color:#676E95;"># \u4EE5\u4E0B\u6307\u4EE4\u5728http/server \u7684location \u4E2D\u751F\u6548 </span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;"> root </span><span style="color:#A6ACCD;">  html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;"> index </span><span style="color:#A6ACCD;"> index.html index.htm</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">			 </span><span style="color:#676E95;"># \u914D\u7F6E\u9519\u8BEF\u9875\u9762</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> error_page </span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">502</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">503</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">504</span><span style="color:#A6ACCD;">  /50x.html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/50x.html </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;"> root </span><span style="color:#A6ACCD;">  html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;"># ******* server end ********</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#676E95;"># ******* http end ********</span></span>
<span class="line"></span></code></pre></div><p>\u6CE8\u610F\uFF1ANginx \u914D\u7F6E\u6587\u4EF6\u4E2D\uFF0C\u6BCF\u4E00\u6761\u6307\u4EE4\u914D\u7F6E\u90FD\u5FC5\u987B\u4EE5\u5206\u53F7\u7ED3\u675F\uFF1B</p><p>\u7ED3\u6784\u5212\u5206\uFF1A</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">\u251C\u2500\u2500\u2500nginx.conf</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2502   \u251C\u2500\u2500\u2500\u5168\u5C40\u5757</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2502   \u251C\u2500\u2500\u2500events</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2502   \u251C\u2500\u2500\u2500http</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2502   \u2502   \u251C\u2500\u2500\u2500server</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2502   \u2502   \u2502   \u251C\u2500\u2500\u2500server \u5168\u5C40\u5757</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2502   \u2502   \u2502   \u251C\u2500\u2500\u2500location</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2502   \u2502   \u2502   \u251C\u2500\u2500\u2500location</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u6CE8\u610F\uFF1A</p><ul><li><p>\u914D\u7F6E\u6587\u4EF6\u652F\u6301\u5927\u91CF\u53EF\u914D\u7F6E\u7684\u6307\u4EE4\uFF0C\u7EDD\u5927\u591A\u6570\u6307\u4EE4\u4E0D\u662F\u7279\u5B9A\u5C5E\u4E8E\u67D0\u4E00\u4E2A\u5757\u7684\uFF1B</p></li><li><p>\u540C\u4E00\u4E2A\u6307\u4EE4\u653E\u5728\u4E0D\u540C\u5C42\u7EA7\u7684\u5757\u4E2D\uFF0C\u5176\u4F5C\u7528\u57DF\u4E5F\u4E0D\u540C\uFF0C\u4E00\u822C\u60C5\u51B5\u4E0B\uFF0C\u9AD8\u4E00\u7EA7\u5757\u4E2D\u7684\u6307\u4EE4\u53EF\u4EE5\u4F5C\u7528\u4E8E\u81EA\u8EAB\u6240\u5728\u7684\u5757\u548C\u6B64\u5757\u5305\u542B\u7684\u6240\u6709\u4F4E\u5C42\u7EA7\u5757\uFF1B\u5982\u679C\u67D0\u4E2A\u6307\u4EE4\u5728\u4E24\u4E2A\u4E0D\u540C\u5C42\u7EA7\u7684\u5757\u4E2D\u540C\u65F6\u51FA\u73B0\uFF0C\u5219\u91C7\u7528\u201C\u5C31\u8FD1\u539F\u5219\u201D\uFF0C\u5373\u8F83\u4F4E\u5C42\u7EA7\u5757\u4E2D\u7684\u914D\u7F6E\u4E3A\u51C6\uFF1B</p><p><em>\uFF08\u5373\uFF1A\u9AD8\u5C42\u7EA7\u5757\u80FD\u51FA\u73B0\u5728\u672C\u7EA7\u53CA\u4EE5\u4E0B\u7684\u5C42\u7EA7\u5757\u4E2D\uFF0C\u5E76\u4E14\u4EE5\u6700\u5C0F\u5C42\u7EA7\u7684\u914D\u7F6E\u4E3A\u51C6\uFF09</em></p></li></ul><h4 id="\u6307\u4EE4\u8BF4\u660E" tabindex="-1">\u6307\u4EE4\u8BF4\u660E <a class="header-anchor" href="#\u6307\u4EE4\u8BF4\u660E" aria-hidden="true">#</a></h4><ul><li><p>user [user] [group];</p><p>\u53EA\u6709\u88AB\u8BBE\u7F6E\u7684\u7528\u6237\u7EC4\u6210\u5458\u624D\u6709\u6743\u9650\u542F\u52A8Nginx\u8FDB\u7A0B\uFF1B</p><p>\u5982\u679C\u5E0C\u671B\u6240\u6709\u7684\u7528\u6237\u90FD\u53EF\u4EE5\u542F\u52A8Nginx\uFF0C\u6709\u4E24\u79CD\u65B9\u6848\uFF1A</p><ul><li>\u6CE8\u91CA <code># user [user] [group]</code>;</li><li>\u6216\u8005\u5C06\u7528\u6237\uFF08\u7528\u6237\u7EC4\uFF09\u8BBE\u7F6E\u4E3A<code>nobody</code>\uFF0C<code>user nobody nobody</code>;</li></ul></li><li><p>worker process\uFF0C\u7406\u8BBA\u4E0A\uFF0C\u503C\u8D8A\u5927\u53EF\u4EE5\u652F\u6301\u7684\u5E76\u53D1\u5904\u7406\u91CF\u5C31\u8D8A\u591A\uFF1B \u914D\u7F6E\u5141\u8BB8\u751F\u6210\u7684 worker process \u6570\u7684\u6307\u4EE4\u662F <code>worker_processes</code></p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">worker_processes </span><span style="color:#A6ACCD;">number | auto</span></span>
<span class="line"></span></code></pre></div><ul><li>number \uFF0C\u6307\u5B9A Nginx \u8FDB\u7A0B\u6700\u591A\u53EF\u4EE5\u4EA7\u751F\u7684 worker process \u6570\uFF1B</li><li>auto\uFF0C Nginx \u8FDB\u7A0B\u5C06\u81EA\u52A8\u8FDB\u884C\u68C0\u6D4B\uFF1B</li></ul><p>\u6CE8\u610F\uFF1A \u6B64\u6307\u4EE4\u53EA\u80FD\u5728\u5168\u5C40\u5757\u4E2D\u8BBE\u7F6E\u3002</p></li><li><p>Nginx \u8FDB\u7A0B PID \u5B58\u653E\u8DEF\u5F84</p><p>\u914D\u7F6E\u6587\u4EF6\u9ED8\u8BA4\u5B58\u653E\u5728Nginx\u5B89\u88C5\u76EE\u5F55logs\u4E0B\uFF0C\u4FEE\u6539\u8BED\u6CD5\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">pid </span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>file \u6307\u5B9A\u5B58\u653E\u8DEF\u5F84\u548C\u6587\u4EF6\u540D\u79F0\uFF0C\u5FC5\u987B\u5E26\u6587\u4EF6\u540D\u79F0\uFF1B</p><p>\u6CE8\u610F\uFF1A\u6B64\u6307\u4EE4\u53EA\u80FD\u5728\u5168\u5C40\u5757\u4E2D\u4F7F\u7528\uFF1B</p></li><li><p>\u914D\u7F6E\u9519\u8BEF\u65E5\u5FD7\u7684\u5B58\u653E\u8DEF\u5F84</p><p>\u5728\u5168\u5C40\u5757\u3001http\u5757\u3001sever\u5757\u4E2D\u90FD\u53EF\u4EE5\u5BF9Nginx\u670D\u52A1\u5668\u7684\u65E5\u5FD7\u8FDB\u884C\u76F8\u5173\u914D\u7F6E\uFF1B</p><p>\u6307\u4EE4<code>error_log</code>\uFF0C\u8BED\u6CD5\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">error_log </span><span style="color:#A6ACCD;">file | stderr [</span><span style="color:#89DDFF;"> debug</span><span style="color:#A6ACCD;"> | info |</span><span style="color:#89DDFF;"> notice</span><span style="color:#A6ACCD;"> |</span><span style="color:#89DDFF;"> warn</span><span style="color:#A6ACCD;"> |</span><span style="color:#89DDFF;"> error</span><span style="color:#A6ACCD;"> |</span><span style="color:#89DDFF;"> crit</span><span style="color:#A6ACCD;"> | alert | emerg ]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>Nginx \u670D\u52A1\u65E5\u5FD7\u652F\u6301\u8F93\u51FA\u5230\u67D0\u4E2A\u6587\u4EF6\u4E0B\uFF0C\u6216\u8005\u8F93\u51FA\u5230\u6807\u51C6\u9519\u8BEF\u8F93\u51FAstderr\uFF1B</p><p>\u65E5\u5FD7\u7B49\u7EA7\uFF1A</p><ul><li>debug \uFF08\u9700\u8981\u5728\u7F16\u8BD1\u65F6\u4F7F\u7528 --with-debug \u5F00\u542F debug \u5F00\u5173\uFF09</li><li>info</li><li>notice</li><li>warn</li><li>error</li><li>crit</li><li>alert</li><li>emerg</li></ul><p>\u6CE8\u610F\uFF1A\u8BBE\u7F6E\u67D0\u4E00\u7EA7\u522B\uFF0C\u6BD4\u8FD9\u4E00\u7EA7\u522B\u9AD8\u7684\u65E5\u5FD7\u4E5F\u4F1A\u88AB\u8BB0\u5F55\uFF1B\u6307\u5B9A\u6587\u4EF6\u5FC5\u987B\u6709\u5199\u7684\u6743\u9650\uFF1B</p><p>\u6B64\u6307\u4EE4\u80FD\u5728\u5168\u5C40\u5757\u3001http\u3001server\u3001location\u5757\u4E2D\u4F7F\u7528\uFF1B</p></li><li><p>\u914D\u7F6E\u6587\u4EF6\u7684\u5F15\u5165</p><p>Nginx \u63D0\u4F9B <code>include</code> \u6307\u4EE4\u6765\u5B8C\u6210\u914D\u7F6E\u6587\u4EF6\u7684\u5F15\u5165\uFF0C\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">include </span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>file \u662F\u8981\u5F15\u5165\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u652F\u6301\u76F8\u5BF9\u8DEF\u5F84\uFF1B</p><p>\u6CE8\u610F\uFF1A\u5F15\u5165\u7684\u6587\u4EF6\uFF0C\u5FC5\u987B\u6709\u5199\u7684\u6743\u9650\uFF0C\u5E76\u4E14\u7B26\u5408Nginx\u914D\u7F6E\u6587\u4EF6\u89C4\u5B9A\u7684\u76F8\u5173\u8BED\u6CD5\u548C\u7ED3\u6784\uFF1B</p><p>\u6B64\u6307\u4EE4\u53EF\u4EE5\u653E\u5728\u914D\u7F6E\u6587\u4EF6\u7684\u4EFB\u610F\u5730\u65B9\uFF1B</p></li><li><p>\u914D\u7F6E\u6700\u5927\u8FDE\u63A5\u6570</p><p>\u6307\u4EE4worker_connections \u4E3B\u8981\u7528\u6765\u8BBE\u7F6E\u5141\u8BB8\u6BCF\u4E00\u4E2A worker process \u540C\u65F6\u5F00\u542F\u6700\u5927\u8FDE\u63A5\u6570\uFF1B</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">worker_connections </span><span style="color:#A6ACCD;">number</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u6CE8\u610F\uFF1Anumber \u4E0D\u4EC5\u6307\u548C\u524D\u7AEF\u7528\u6237\u5EFA\u7ACB\u7684\u8FDE\u63A5\u6570\uFF0C\u800C\u662F\u5305\u62EC\u6240\u6709\u53EF\u80FD\u7684\u8FDE\u63A5\u6570\uFF1B</p><p>\u6B64\u6307\u4EE4\u53EA\u80FD\u5728events\u4E2D\u914D\u7F6E\uFF0C\u4E14\u9ED8\u8BA4\u662F512\uFF1B</p></li><li><p>\u81EA\u5B9A\u4E49\u670D\u52A1\u65E5\u5FD7</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">access_log </span><span style="color:#A6ACCD;">path [format [buffer=size]]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u53D6\u6D88\u670D\u52A1\u65E5\u5FD7\u529F\u80FD\u6307\u4EE4\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">access_log </span><span style="color:#A6ACCD;">off</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u6B64\u6307\u4EE4\u53EA\u80FD\u5728http\u5757\u4E2D\u8FDB\u884C\u914D\u7F6E\uFF1B</p></li><li><p>\u914D\u7F6E\u5141\u8BB8sendfile \u65B9\u5F0F\u4F20\u8F93\u6587\u4EF6</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">sendfile </span><span style="color:#A6ACCD;">on|off</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u7528\u4E8E\u5F00\u542F\u6216\u5173\u95ED\u4F7F\u7528sendfile()\u4F20\u8F93\u6587\u4EF6\uFF0C\u9ED8\u8BA4\u503C\u662Foff;</p><p>\u4F20\u8F93\u6587\u4EF6\u5927\u5C0F\u9650\u5236\uFF0C\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">sendfile_max_chunk </span><span style="color:#A6ACCD;">size</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>size &gt; 0 \uFF0C\u8868\u793ANginx\u8FDB\u7A0B\u7684\u6BCF\u4E2Aworker process \u6BCF\u6B21\u8C03\u7528sendfile() \u4F20\u8F93\u7684\u6570\u636E\u91CF\u6700\u5927\u4E0D\u80FD\u8D85\u8FC7\u8FD9\u4E2A\u503C\uFF1B</p><p>size = 0\uFF0C\u8868\u793A\u65E0\u9650\u5236\uFF1B</p><p>\u6B64\u6307\u4EE4\u53EF\u4EE5\u5728 http\u3001server\u3001location \u5757\u4E2D\u914D\u7F6E\uFF1B</p></li><li><p>\u914D\u7F6E\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">keepalive_timeout </span><span style="color:#A6ACCD;">timeout [header_timeout]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>timeout\uFF0C\u670D\u52A1\u7AEF\u5BF9\u8FDE\u63A5\u5F97\u4FDD\u6301\u65F6\u95F4\uFF0C\u9ED8\u8BA4\u662F75s\uFF1B</li><li>header_timeout\uFF0C\u53EF\u9009\u9879\uFF0C\u5728\u5E94\u7B54\u62A5\u6587\u5934\u90E8\u7684 Keep-Alive \u57DF\u8BBE\u7F6E\u8D85\u65F6\u65F6\u95F4\uFF1B</li></ul><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">keepalive_timeout </span><span style="color:#A6ACCD;">120s </span><span style="color:#F78C6C;">100s</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u8868\u8FBE\u542B\u4E49\u662F\uFF0C\u5728\u670D\u52A1\u7AEF\u4FDD\u6301\u8FDE\u63A5\u7684\u65F6\u95F4\u8BBE\u7F6E\u4E3A120s\uFF0C\u53D1\u7ED9\u7528\u6237\u7AEF\u7684\u5E94\u7B54\u62A5\u6587\u5934\u90E8\u4E2D Keep-Alive \u57DF\u7684\u8D85\u65F6\u65F6\u95F4\u8BBE\u7F6E\u4E3A100s\uFF1B</p><p>\u6B64\u6307\u4EE4\u53EF\u4EE5\u5728http\u3001server\u3001location\u5757\u4E2D\u914D\u7F6E\uFF1B</p></li><li><p>\u5355\u8FDE\u63A5\u8BF7\u6C42\u6570\u4E0A\u9650</p><p>Nginx\u670D\u52A1\u5668\u548C\u7528\u6237\u7AEF\u5EFA\u7ACB\u4F1A\u8BDD\u8FDE\u63A5\u540E\uFF0C\u7528\u6237\u7AEF\u901A\u8FC7\u6B64\u8FDE\u63A5\u53D1\u9001\u8BF7\u6C42\uFF0C\u6307\u4EE4keepalive_requests \u7528\u4E8E\u9650\u5236\u7528\u6237\u901A\u8FC7\u67D0\u4E00\u8FDE\u63A5\u5411Nginx\u670D\u52A1\u5668\u53D1\u9001\u8BF7\u6C42\u7684\u6B21\u6570\uFF1B\u9ED8\u8BA4\u662F100\uFF1B</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">keepalive_requests </span><span style="color:#A6ACCD;">number</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u6B64\u6307\u4EE4\u53EF\u4EE5\u5728http\u3001server\u3001location\u4E2D\u914D\u7F6E\uFF1B</p></li><li><p>client_header_buffer_size\u3001large_client_header_buffers</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">client_header_buffer_size </span><span style="color:#A6ACCD;">1k</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u5047\u8BBE<code>client_header_buffer_size</code>\u8BBE\u7F6E\u4E3A 1k\uFF0C\u8868\u793A <em>\u8BF7\u6C42\u884C+\u8BF7\u6C42\u5934</em> \u7684\u5927\u5C0F &lt; 1k\uFF0C\u653E\u884C\u8BF7\u6C42\uFF0C&gt;= 1k\uFF0C\u4EE5 <code>large_header_buffer_size</code>\u4E3A\u51C6\uFF1B</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">large_header_buffer_sizes</span><span style="color:#A6ACCD;"> 4 </span><span style="color:#F78C6C;">8k</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u5047\u8BBE <code>large_header_buffer_size</code>\u7684\u914D\u7F6E\u4E3A 4 8k\uFF0C\u5219\u5BF9\u8BF7\u6C42\u7684\u8981\u6C42\uFF1A</p><ul><li>\u8BF7\u6C42\u884C\uFF08requests line\uFF09\u7684\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 8k\uFF0C\u5426\u5219\u8FD4\u56DE 414 \u9519\u8BEF\uFF1B</li><li>\u8BF7\u6C42\u5934 \uFF08requests header\uFF09\u7684\u6BCF\u4E00\u4E2A\u5934\u90E8\u5B57\u6BB5\u7684\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 8k \uFF0C\u5426\u5219\u8FD4\u56DE 404 \u9519\u8BEF <code>curl -H &quot;header1=aaa&quot; -H &quot;header2=bbb&quot; -v http://127.0.0.1/</code>\uFF0C\u8FD9\u91CC\u7684 header1=aaa \u548C header2=bbb \u5C31\u662F\u8BF7\u6C42\u5934\u4E2D\u7684\u5934\u90E8\u5B57\u6BB5</li><li><em>\u8BF7\u6C42\u5934+\u8BF7\u6C42\u884C</em> \u7684\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 32K (4*8k)\uFF1B</li></ul></li><li><p>\u57FA\u4E8E\u540D\u79F0\u7684\u865A\u62DF\u4E3B\u673A\u914D\u7F6E</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">server_name </span><span style="color:#A6ACCD;">name ...</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>name\uFF1A\u53EF\u4EE5\u53EA\u6709\u4E00\u4E2A\u540D\u79F0\uFF0C\u4E5F\u53EF\u4EE5\u591A\u4E2A\u5E76\u5217\uFF0C\u4E4B\u95F4\u7528\u7A7A\u683C\u9694\u5F00\uFF1B\u6BCF\u4E2A\u540D\u5B57\u5C31\u662F\u4E2A\u57DF\u540D\uFF0C\u6709\u4E24\u6BB5\u6216\u4E09\u6BB5\u7EC4\u6210\uFF0C\u4E4B\u95F4\u7531\u201C.\u201D \u9694\u5F00\uFF1B</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">server_name </span><span style="color:#A6ACCD;">myserver.com www.myserver.com</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u7B2C\u4E00\u4E2A\u540D\u79F0\u4F5C\u4E3A\u865A\u62DF\u4E3B\u673A\u7684\u4E3B\u8981\u540D\u79F0\uFF1B</p><p><code>server_name</code> \u5339\u914D\u89C4\u5219\u4F18\u5148\u7EA7\u987A\u5E8F\uFF1A</p><ol><li>\u51C6\u786E\u5339\u914D<code>server_name</code> \uFF0C\u5982\uFF1A<code>server_name www.myserver.com</code>\uFF1B</li><li>\u901A\u914D\u7B26\u5728\u5F00\u59CB\u65F6\u5339\u914D<code>server_name</code>\u6210\u529F\uFF0C\u5982\uFF1A<code>server_name *.myserver.com</code>\uFF1B</li><li>\u901A\u914D\u7B26\u5728\u7ED3\u675F\u65F6\u5339\u914D<code>server_name</code>\u6210\u529F\uFF0C\u5982\uFF1A<code>server_name www.myserver.*</code>\uFF1B</li><li>\u6B63\u5219\u8868\u8FBE\u5F0F\u5339\u914D<code>server_name</code>\u6210\u529F\uFF0C\u5982\uFF1A<code>server_name ~^www\\d+\\.myserver.\\com$</code>\uFF1B<em>\uFF08ps\uFF1A\u6B63\u5219\u8868\u8FBE\u5F0F\u7528\u201C~\u201D\u6807\u8BB0\uFF09</em></li></ol><p>\u6CE8\u610F\uFF1A<code>server_name</code>\u5904\u4E8E\u7EDF\u4E00\u4F18\u5148\u7EA7\u7684\u5339\u914D\u65B9\u5F0F\u591A\u6B21\u6210\u529F\uFF0C\u5219\u9996\u6B21\u5339\u914D\u6210\u529F\u7684\u865A\u62DF\u673A\u5904\u7406\u8BF7\u6C42\uFF1B</p></li><li><p>location</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">[ = | ~ | ~* | ^~ ] uri</span><span style="color:#A6ACCD;">{...};</span></span>
<span class="line"></span></code></pre></div><ul><li>= \uFF1A \u8868\u793A\u4E25\u683C\u5339\u914D\uFF1B</li><li>~ \uFF1A\u7528\u4E8E\u8868\u793A uri \u5305\u542B\u7684\u6B63\u5219\u8868\u8FBE\u5F0F\uFF0C\u5E76\u533A\u5206\u5927\u5C0F\u5199\uFF1B</li><li>~* \uFF1A\u7528\u4E8E\u8868\u793A uri \u5305\u542B\u7684\u6B63\u5219\u8868\u8FBE\u5F0F\uFF0C\u5E76\u4E0D\u533A\u5206\u5927\u5C0F\u5199\uFF1B</li></ul></li><li><p>\u914D\u7F6E\u8BF7\u6C42\u6839\u76EE\u5F55</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">root </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div></li><li><p>\u66F4\u6539 location \u7684 URI</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">alias </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div></li><li><p>\u8BBE\u7F6E\u7F51\u7AD9\u7684\u9ED8\u8BA4\u9996\u9875</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">index </span><span style="color:#A6ACCD;">file ...</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u5176\u4E2D file \u53D8\u91CF\u53EF\u4EE5\u5305\u62EC\u591A\u4E2A\u6587\u4EF6\u540D\uFF0C\u5176\u4ED6\u4F7F\u7528\u7A7A\u683C\u5206\u9694\uFF0C\u4E5F\u53EF\u4EE5\u5305\u542B\u5176\u4ED6\u53D8\u91CF\uFF1B</p><p>\u4F8B\u5982\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">~^/data/(.+)/web$ </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#89DDFF;">	index </span><span style="color:#A6ACCD;">index.</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">1.html  index.my01.html index.html</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><p>\u5176\u4E2D <code>~</code> \u5F00\u5934\u7684\u8868\u793A\u6B63\u5219\u5339\u914D\uFF0C<code>(.+)</code> \u8868\u793A\u53D8\u91CF\uFF0C\u5373\u5F53\u63A5\u6536\u5230 &quot;/data/locationtest/web/&quot;\u65F6\uFF0C\u4F1A\u4F9D\u6B21\u5339\u914D /data/locationtest/web/ \u8DEF\u5F84\u4E0B\u7684 index.locationtest.html\u3001index.my01.html\u3001index.html \u9875\u9762\uFF1B</p></li><li><p>\u8BBE\u7F6E\u7F51\u7AD9\u7684\u9519\u8BEF\u9875\u9762 <a href="./../HTTP/\u5E38\u89C1\u9519\u8BEF\u7801">HTTP \u5E38\u89C1\u9519\u8BEF\u7801</a></p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">error_page </span><span style="color:#A6ACCD;">code ... [=[response]] uri</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>code \uFF1A\u8981\u5904\u7406\u7684HTTP \u9519\u8BEF\u7801\uFF1B</li><li>response\uFF1A\u53EF\u9009\uFF0C\u5C06 code \u6307\u5B9A\u7684\u9519\u8BEF\u7801\u8F6C\u6362\u4E3A\u65B0\u7684\u9519\u8BEF\u4EE3\u7801 response\uFF1B</li><li>uri\uFF1A\u9519\u8BEF\u9875\u9762\u7684\u8DEF\u5F84\u6216\u8005\u7F51\u7AD9\u5730\u5740\uFF0C\u53EF\u4EE5\u662F\u76F8\u5BF9\u8DEF\u5F84\uFF08\u76F8\u5BF9Nginx\u5B89\u88C5\u8DEF\u5F84\u4E0B\u7684html\u76EE\u5F55\u4E3A\u6839\u8DEF\u5F84\u7684\u76F8\u5BF9\u8DEF\u5F84\uFF09\uFF0C\u53EF\u4EE5\u8BF4\u662F\u7F51\u5740\uFF1B</li></ul></li><li><p>\u57FA\u4E8E IP \u914D\u7F6E Nginx \u7684\u8BBF\u95EE\u6743\u9650</p><p>\u5141\u8BB8\u6307\u4EE4\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">allow </span><span style="color:#A6ACCD;">address | CIDR |</span><span style="color:#89DDFF;"> all;</span></span>
<span class="line"></span></code></pre></div><ul><li>address\uFF1A\u5141\u8BB8\u8BBF\u95EE\u5BA2\u6237\u7AEF\u7684 IP \uFF0C\u4E0D\u652F\u6301\u540C\u4E8B\u8BBE\u7F6E\u591A\u4E2A\uFF0C\u5982\u679C\u9700\u8981\u8BBE\u7F6E\u591A\u4E2A\u9700\u8981\u91CD\u590D\u4F7F\u7528 allow\uFF1B</li><li>CIDR\uFF1A\u5141\u8BB8\u8BBF\u95EE\u7684\u5BA2\u6237\u7AEF\u7684 CIDR \u5730\u5740\uFF1B</li><li>all\uFF1A\u4EE3\u8868\u5141\u8BB8\u6240\u6709\u5BA2\u6237\u7AEF\u8BBF\u95EE\uFF1B</li></ul><p>\u7981\u6B62\u8BBF\u95EE\u6307\u4EE4\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">deny </span><span style="color:#A6ACCD;">address | CIDR |</span><span style="color:#89DDFF;"> all;</span></span>
<span class="line"></span></code></pre></div><p>\u6B64\u6307\u4EE4\u53EF\u4EE5\u5728http\u3001server\u3001location\u4E2D\u914D\u7F6E\uFF1B</p></li><li><p>\u57FA\u4E8E\u5BC6\u7801\u914D\u7F6E Nginx \u7684\u8BBF\u95EE\u6743\u9650</p><p>\u8BED\u6CD5\u7ED3\u6784\uFF1A</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">auth_basic </span><span style="color:#A6ACCD;"> string |</span><span style="color:#89DDFF;"> off;</span></span>
<span class="line"></span></code></pre></div><ul><li>string\uFF1A\u5F00\u542F\u8BE5\u8BA4\u8BC1\u529F\u80FD\uFF0C\u7528\u4E8E\u914D\u7F6E\u9A8C\u8BC1\u65F6\u7684\u6307\u793A\u4FE1\u606F\uFF1B</li><li>off\uFF1A\u5173\u95ED\u8BE5\u8BA4\u8BC1\u529F\u80FD\uFF1B</li></ul><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">auth_basic_user_file </span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u5176\u4E2D\uFF0Cfile \u4E3A\u5BC6\u7801\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84\uFF1B</p></li></ul>`,11),o=[e];function c(t,i,r,y,C,d){return a(),n("div",null,o)}const g=s(p,[["render",c]]);export{A as __pageData,g as default};
