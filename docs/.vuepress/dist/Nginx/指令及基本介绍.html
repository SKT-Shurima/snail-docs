<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginx 命令： | 37.3℃</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/images/logo.jpg">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="技术博客">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/images/logo.jpg">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="keywords" content="37.3,vue,vuepress,vuepress-theme,theme,主题,vuepress主题,blog
    ,vuepress-blog,java,python,shell,sql,golang,script,shell script,nginx,windows,linux">
    <meta name="referrer" content="never">
    
    <link rel="preload" href="/assets/css/0.styles.14667330.css" as="style"><link rel="preload" href="/assets/js/app.12b19b72.js" as="script"><link rel="preload" href="/assets/js/2.a96faf37.js" as="script"><link rel="preload" href="/assets/js/55.2446979d.js" as="script"><link rel="prefetch" href="/assets/js/10.ff1e279c.js"><link rel="prefetch" href="/assets/js/11.367a7df3.js"><link rel="prefetch" href="/assets/js/12.2aef19d2.js"><link rel="prefetch" href="/assets/js/13.dc816d48.js"><link rel="prefetch" href="/assets/js/14.ed6e2436.js"><link rel="prefetch" href="/assets/js/15.810e8e44.js"><link rel="prefetch" href="/assets/js/16.81854c69.js"><link rel="prefetch" href="/assets/js/17.719bf796.js"><link rel="prefetch" href="/assets/js/18.42219d65.js"><link rel="prefetch" href="/assets/js/19.7b9c6adf.js"><link rel="prefetch" href="/assets/js/20.7e571468.js"><link rel="prefetch" href="/assets/js/21.0dde288a.js"><link rel="prefetch" href="/assets/js/22.49b80545.js"><link rel="prefetch" href="/assets/js/23.bc80c1c3.js"><link rel="prefetch" href="/assets/js/24.2d7b925b.js"><link rel="prefetch" href="/assets/js/25.ee1a7d89.js"><link rel="prefetch" href="/assets/js/26.49a3f8ba.js"><link rel="prefetch" href="/assets/js/27.7c2c1faf.js"><link rel="prefetch" href="/assets/js/28.d0695e20.js"><link rel="prefetch" href="/assets/js/29.438fe619.js"><link rel="prefetch" href="/assets/js/3.241577d6.js"><link rel="prefetch" href="/assets/js/30.3b8b21be.js"><link rel="prefetch" href="/assets/js/31.ee317aa4.js"><link rel="prefetch" href="/assets/js/32.baeded1c.js"><link rel="prefetch" href="/assets/js/33.686b11df.js"><link rel="prefetch" href="/assets/js/34.9049e3bd.js"><link rel="prefetch" href="/assets/js/35.ccfbfd9e.js"><link rel="prefetch" href="/assets/js/36.8add82d0.js"><link rel="prefetch" href="/assets/js/37.b0790515.js"><link rel="prefetch" href="/assets/js/38.7043f833.js"><link rel="prefetch" href="/assets/js/39.4e1e0ab1.js"><link rel="prefetch" href="/assets/js/4.9052a845.js"><link rel="prefetch" href="/assets/js/40.812cc004.js"><link rel="prefetch" href="/assets/js/41.0d9ae2f5.js"><link rel="prefetch" href="/assets/js/42.504a412c.js"><link rel="prefetch" href="/assets/js/43.500cdad8.js"><link rel="prefetch" href="/assets/js/44.74aeb4b9.js"><link rel="prefetch" href="/assets/js/45.9350db71.js"><link rel="prefetch" href="/assets/js/46.f51c110f.js"><link rel="prefetch" href="/assets/js/47.608bdd07.js"><link rel="prefetch" href="/assets/js/48.eba07a86.js"><link rel="prefetch" href="/assets/js/49.3dc8be14.js"><link rel="prefetch" href="/assets/js/5.467507bd.js"><link rel="prefetch" href="/assets/js/50.2b93bf53.js"><link rel="prefetch" href="/assets/js/51.3899624b.js"><link rel="prefetch" href="/assets/js/52.0018ead9.js"><link rel="prefetch" href="/assets/js/53.a460987a.js"><link rel="prefetch" href="/assets/js/54.de55254a.js"><link rel="prefetch" href="/assets/js/56.c10cde3f.js"><link rel="prefetch" href="/assets/js/57.c44c9f58.js"><link rel="prefetch" href="/assets/js/58.9028c985.js"><link rel="prefetch" href="/assets/js/59.5346ed19.js"><link rel="prefetch" href="/assets/js/6.db41cb70.js"><link rel="prefetch" href="/assets/js/60.4b1994be.js"><link rel="prefetch" href="/assets/js/61.e3f05c99.js"><link rel="prefetch" href="/assets/js/62.4b109a36.js"><link rel="prefetch" href="/assets/js/63.1e16cb3a.js"><link rel="prefetch" href="/assets/js/64.6899947d.js"><link rel="prefetch" href="/assets/js/65.05ef9822.js"><link rel="prefetch" href="/assets/js/66.f7cdcc05.js"><link rel="prefetch" href="/assets/js/67.b0b5a3e1.js"><link rel="prefetch" href="/assets/js/68.d87ac822.js"><link rel="prefetch" href="/assets/js/69.0fafc49a.js"><link rel="prefetch" href="/assets/js/7.388cf533.js"><link rel="prefetch" href="/assets/js/70.33387b1d.js"><link rel="prefetch" href="/assets/js/8.4b45278a.js"><link rel="prefetch" href="/assets/js/9.6dc9941e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.14667330.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo.jpg" alt="37.3℃" class="logo"> <span class="site-name can-hide">37.3℃</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Axios/" class="nav-link">
  Axios
</a></div><div class="nav-item"><a href="/Docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/Git/" class="nav-link">
  Git
</a></div><div class="nav-item"><a href="/HTML&amp;&amp;CSS/" class="nav-link">
  HTML&amp;&amp;CSS
</a></div><div class="nav-item"><a href="/HTTP/" class="nav-link">
  HTTP
</a></div><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/JavaScript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/Linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/Nginx/" class="nav-link router-link-active">
  Nginx
</a></div><div class="nav-item"><a href="/Node/" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/Python/" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/React/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/Window/" class="nav-link">
  Window
</a></div><div class="nav-item"><a href="/dev-tools/" class="nav-link">
  dev-tools
</a></div> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Axios/" class="nav-link">
  Axios
</a></div><div class="nav-item"><a href="/Docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/Git/" class="nav-link">
  Git
</a></div><div class="nav-item"><a href="/HTML&amp;&amp;CSS/" class="nav-link">
  HTML&amp;&amp;CSS
</a></div><div class="nav-item"><a href="/HTTP/" class="nav-link">
  HTTP
</a></div><div class="nav-item"><a href="/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/JavaScript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/Linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/Nginx/" class="nav-link router-link-active">
  Nginx
</a></div><div class="nav-item"><a href="/Node/" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/Python/" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/React/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/Window/" class="nav-link">
  Window
</a></div><div class="nav-item"><a href="/dev-tools/" class="nav-link">
  dev-tools
</a></div> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Nginx/" aria-current="page" class="sidebar-link">/Nginx/</a></li><li><a href="/Nginx/Gzip 压缩.html" class="sidebar-link">Gzip 压缩</a></li><li><a href="/Nginx/Nginx 架构设计.html" class="sidebar-link">Nginx 服务器的 Web 请求处理机制</a></li><li><a href="/Nginx/Rewrite.html" class="sidebar-link">Rewrite</a></li><li><a href="/Nginx/command.html" class="sidebar-link">Nginx 常用命令</a></li><li><a href="/Nginx/指令及基本介绍.html" class="active sidebar-link">Nginx 命令：</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Nginx/正向代理和反向代理.html" class="sidebar-link">正向代理、反向代理</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="nginx-命令"><a href="#nginx-命令" class="header-anchor">#</a> Nginx 命令：</h3> <div class="language-nginx extra-class"><pre class="language-nginx"><code>$ nginx -t  // 查看Nginx服务器配置文件是否有语法错误
</code></pre></div><h3 id="nginx-conf-原始配置文件"><a href="#nginx-conf-原始配置文件" class="header-anchor">#</a> Nginx.conf  原始配置文件</h3> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token comment"># nginx.conf 原始文件</span>

<span class="token comment"># ******* 全局块 start ********</span>
<span class="token comment"># 只有被设置的用户组成员才有权限启动Nginx进程</span>
<span class="token comment"># user nobody</span>

<span class="token comment"># 全局生效，配置允许 Nginx 进程生成的 worker_process 数量</span>
<span class="token directive"><span class="token keyword">worker_processes</span>  <span class="token number">1</span></span><span class="token punctuation">;</span>

<span class="token comment"># 配置 Nginx 服务器运行对错误日志存放的路径</span>
<span class="token comment"># error_log logs/error.log</span>

<span class="token comment"># 配置 Nginx 运行时，pid 文件存放路径和名称；</span>
<span class="token comment"># pid nginx.pid</span>
<span class="token comment"># ******* 全局块 end ********</span>

<span class="token comment"># ******* events start ********</span>
<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
		<span class="token comment"># 配置事件驱动模型</span>
		<span class="token comment"># use epoll;</span>
		
		<span class="token comment"># 在events部分中生效</span>
    <span class="token directive"><span class="token keyword">worker_connections</span>  <span class="token number">1024</span></span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
<span class="token comment"># ******* events end ********</span>

<span class="token comment"># ******* http start ********</span>
<span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
 		<span class="token comment"># 以下指令在http的server部分中生效</span>
 		<span class="token comment"># 定义 MIME-Type</span>
    <span class="token directive"><span class="token keyword">include</span>       mime.types</span><span class="token punctuation">;</span>   
    <span class="token directive"><span class="token keyword">default_type</span>  application/octet-stream</span><span class="token punctuation">;</span>
    <span class="token comment"># 配置允许使用sendfile 方式传输</span>
    <span class="token directive"><span class="token keyword">sendfile</span>        <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token comment"># 配置连接超时时间</span>
    <span class="token directive"><span class="token keyword">keepalive_timeout</span>  <span class="token number">65</span></span><span class="token punctuation">;</span>
    <span class="token comment"># 配置请求处理日志的格式</span>
    <span class="token comment"># log_format access.log '$remote_addr-[$time_local]-&quot;$request&quot;-&quot;$http_user_agent&quot;';</span>
    
    <span class="token comment"># 请求行+请求头的标准大小为1k</span>
    <span class="token comment"># client_header_buffer_size 1k;</span>
    <span class="token comment"># 请求行+请求头的最大大小为2k</span>
	  <span class="token comment"># large_client_header_buffers 2 1k;</span>
    
    <span class="token comment"># ******* server start ********</span>
    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    		<span class="token comment"># 配置监听端口和主机名称（基于名称）</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">8080</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>
        <span class="token comment"># 配置请求处理日志存放路径</span>
        <span class="token comment"># access_log /myweb/server1/log/access.log</span>
        
        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>            <span class="token comment"># 以下指令在http/server 的location 中生效 </span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
			 <span class="token comment"># 配置错误页面</span>
        <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
    <span class="token comment"># ******* server end ********</span>
<span class="token punctuation">}</span>
<span class="token comment"># ******* http end ********</span>
</code></pre></div><p>注意：Nginx 配置文件中，每一条指令配置都必须以分号结束；</p> <p>结构划分：</p> <div class="language- extra-class"><pre class="language-text"><code>├───nginx.conf
│   ├───全局块
│   ├───events
│   ├───http
│   │   ├───server
│   │   │   ├───server 全局块
│   │   │   ├───location
│   │   │   ├───location
</code></pre></div><p>注意：</p> <ul><li><p>配置文件支持大量可配置的指令，绝大多数指令不是特定属于某一个块的；</p></li> <li><p>同一个指令放在不同层级的块中，其作用域也不同，一般情况下，高一级块中的指令可以作用于自身所在的块和此块包含的所有低层级块；如果某个指令在两个不同层级的块中同时出现，则采用“就近原则”，即较低层级块中的配置为准；</p> <p><em>（即：高层级块能出现在本级及以下的层级块中，并且以最小层级的配置为准）</em></p></li></ul> <h4 id="指令说明"><a href="#指令说明" class="header-anchor">#</a> 指令说明</h4> <ul><li><p>user  [user] [group];</p> <p>只有被设置的用户组成员才有权限启动Nginx进程；</p> <p>如果希望所有的用户都可以启动Nginx，有两种方案：</p> <ul><li>注释 <code># user [user] [group]</code>;</li> <li>或者将用户（用户组）设置为<code>nobody</code>，<code>user nobody nobody</code>;</li></ul></li> <li><p>worker process，理论上，值越大可以支持的并发处理量就越多；
配置允许生成的 worker process 数的指令是 <code>worker_processes</code></p> <div class="language-nginx extra-class"><pre class="language-nginx"><code>worker_processes number | auto
</code></pre></div><ul><li>number ，指定 Nginx 进程最多可以产生的 worker process 数；</li> <li>auto， Nginx 进程将自动进行检测；</li></ul> <p>注意： 此指令只能在全局块中设置。</p></li> <li><p>Nginx 进程 PID 存放路径</p> <p>配置文件默认存放在Nginx安装目录logs下，修改语法：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">pid</span> file</span><span class="token punctuation">;</span>
</code></pre></div><p>file 指定存放路径和文件名称，必须带文件名称；</p> <p>注意：此指令只能在全局块中使用；</p></li> <li><p>配置错误日志的存放路径</p> <p>在全局块、http块、sever块中都可以对Nginx服务器的日志进行相关配置；</p> <p>指令<code>error_log</code>，语法：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">error_log</span> file | stderr [ debug | info | notice | warn | error | crit | alert | emerg ]</span><span class="token punctuation">;</span>
</code></pre></div><p>Nginx 服务日志支持输出到某个文件下，或者输出到标准错误输出stderr；</p> <p>日志等级：</p> <ul><li>debug  （需要在编译时使用 --with-debug 开启 debug 开关）</li> <li>info</li> <li>notice</li> <li>warn</li> <li>error</li> <li>crit</li> <li>alert</li> <li>emerg</li></ul> <p>注意：设置某一级别，比这一级别高的日志也会被记录；指定文件必须有写的权限；</p> <p>此指令能在全局块、http、server、location块中使用；</p></li> <li><p>配置文件的引入</p> <p>Nginx 提供 <code>include</code> 指令来完成配置文件的引入，语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">include</span> file</span><span class="token punctuation">;</span>
</code></pre></div><p>file 是要引入的配置文件，支持相对路径；</p> <p>注意：引入的文件，必须有写的权限，并且符合Nginx配置文件规定的相关语法和结构；</p> <p>此指令可以放在配置文件的任意地方；</p></li> <li><p>配置最大连接数</p> <p>指令worker_connections 主要用来设置允许每一个 worker process 同时开启最大连接数；</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">worker_connections</span> number</span><span class="token punctuation">;</span>
</code></pre></div><p>注意：number 不仅指和前端用户建立的连接数，而是包括所有可能的连接数；</p> <p>此指令只能在events中配置，且默认是512；</p></li> <li><p>自定义服务日志</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">access_log</span> path [format [buffer=size]]</span><span class="token punctuation">;</span>
</code></pre></div><p>取消服务日志功能指令：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">access_log</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
</code></pre></div><p>此指令只能在http块中进行配置；</p></li> <li><p>配置允许sendfile 方式传输文件</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">sendfile</span> on|off</span><span class="token punctuation">;</span>
</code></pre></div><p>用于开启或关闭使用sendfile()传输文件，默认值是off;</p> <p>传输文件大小限制，语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">sendfile_max_chunk</span> size</span><span class="token punctuation">;</span>
</code></pre></div><p>size &gt; 0 ，表示Nginx进程的每个worker process 每次调用sendfile() 传输的数据量最大不能超过这个值；</p> <p>size = 0，表示无限制；</p> <p>此指令可以在 http、server、location 块中配置；</p></li> <li><p>配置连接超时时间</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">keepalive_timeout</span> timeout [header_timeout]</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>timeout，服务端对连接得保持时间，默认是75s；</li> <li>header_timeout，可选项，在应答报文头部的 Keep-Alive 域设置超时时间；</li></ul> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">keepalive_timeout</span> <span class="token number">120s</span> <span class="token number">100s</span></span><span class="token punctuation">;</span>
</code></pre></div><p>表达含义是，在服务端保持连接的时间设置为120s，发给用户端的应答报文头部中 Keep-Alive 域的超时时间设置为100s；</p> <p>此指令可以在http、server、location块中配置；</p></li> <li><p>单连接请求数上限</p> <p>Nginx服务器和用户端建立会话连接后，用户端通过此连接发送请求，指令keepalive_requests 用于限制用户通过某一连接向Nginx服务器发送请求的次数；默认是100；</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">keepalive_requests</span> number</span><span class="token punctuation">;</span>
</code></pre></div><p>此指令可以在http、server、location中配置；</p></li> <li><p>client_header_buffer_size、large_client_header_buffers</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">client_header_buffer_size</span> <span class="token number">1k</span></span><span class="token punctuation">;</span>
</code></pre></div><p>假设<code>client_header_buffer_size</code>设置为 1k，表示 <em>请求行+请求头</em> 的大小 &lt; 1k，放行请求，&gt;= 1k，以 <code>large_header_buffer_size</code>为准；</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">large_header_buffer_sizes</span> <span class="token number">4</span> <span class="token number">8k</span></span><span class="token punctuation">;</span>
</code></pre></div><p>假设 <code>large_header_buffer_size</code>的配置为 4 8k，则对请求的要求：</p> <ul><li>请求行（requests line）的大小不能超过 8k，否则返回 414 错误；</li> <li>请求头 （requests header）的每一个头部字段的大小不能超过 8k ，否则返回 404 错误
<code>curl -H &quot;header1=aaa&quot; -H &quot;header2=bbb&quot; -v http://127.0.0.1/</code>，这里的 header1=aaa 和 header2=bbb 就是请求头中的头部字段</li> <li><em>请求头+请求行</em> 的大小不能超过 32K (4*8k)；</li></ul></li> <li><p>基于名称的虚拟主机配置</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server_name</span> name ...</span><span class="token punctuation">;</span>
</code></pre></div><p>name：可以只有一个名称，也可以多个并列，之间用空格隔开；每个名字就是个域名，有两段或三段组成，之间由“.” 隔开；</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server_name</span> myserver.com www.myserver.com</span><span class="token punctuation">;</span>
</code></pre></div><p>第一个名称作为虚拟主机的主要名称；</p> <p><code>server_name</code> 匹配规则优先级顺序：</p> <ol><li>准确匹配<code>server_name</code> ，如：<code>server_name www.myserver.com</code>；</li> <li>通配符在开始时匹配<code>server_name</code>成功，如：<code>server_name *.myserver.com</code>；</li> <li>通配符在结束时匹配<code>server_name</code>成功，如：<code>server_name www.myserver.*</code>；</li> <li>正则表达式匹配<code>server_name</code>成功，如：<code>server_name ~^www\d+\.myserver.\com$</code>；<em>（ps：正则表达式用“~”标记）</em></li></ol> <p>注意：<code>server_name</code>处于统一优先级的匹配方式多次成功，则首次匹配成功的虚拟机处理请求；</p></li> <li><p>location</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span>  [ = | ~ | ~* | ^~ ] uri</span><span class="token punctuation">{</span>...<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>=  ： 表示严格匹配；</li> <li>~  ：用于表示 uri 包含的正则表达式，并区分大小写；</li> <li>~*  ：用于表示 uri 包含的正则表达式，并不区分大小写；</li></ul></li> <li><p>配置请求根目录</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">root</span> path</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>更改 location 的 URI</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">alias</span> path</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>设置网站的默认首页</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">index</span> file ...</span><span class="token punctuation">;</span>
</code></pre></div><p>其中 file 变量可以包括多个文件名，其他使用空格分隔，也可以包含其他变量；</p> <p>例如：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> ~^/data/(.+)/web$</span> <span class="token punctuation">{</span>
	index index.$1.html  index.my01.html index.html
<span class="token punctuation">}</span>
</code></pre></div><p>其中 <code>~</code> 开头的表示正则匹配，<code>(.+)</code> 表示变量，即当接收到 &quot;/data/locationtest/web/&quot;时，会依次匹配 /data/locationtest/web/ 路径下的 index.locationtest.html、index.my01.html、index.html 页面；</p></li> <li><p>设置网站的错误页面  <a href="/HTTP/常见错误码.html">HTTP 常见错误码</a></p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">error_page</span> code ... [=[response]] uri</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>code ：要处理的HTTP 错误码；</li> <li>response：可选，将 code 指定的错误码转换为新的错误代码 response；</li> <li>uri：错误页面的路径或者网站地址，可以是相对路径（相对Nginx安装路径下的html目录为根路径的相对路径），可以说是网址；</li></ul></li> <li><p>基于 IP 配置 Nginx 的访问权限</p> <p>允许指令：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">allow</span> address | CIDR | all</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>address：允许访问客户端的 IP ，不支持同事设置多个，如果需要设置多个需要重复使用 allow；</li> <li>CIDR：允许访问的客户端的 CIDR 地址；</li> <li>all：代表允许所有客户端访问；</li></ul> <p>禁止访问指令：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">deny</span> address | CIDR | all</span><span class="token punctuation">;</span>
</code></pre></div><p>此指令可以在http、server、location中配置；</p></li> <li><p>基于密码配置 Nginx 的访问权限</p> <p>语法结构：</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">auth_basic</span>  string | <span class="token boolean">off</span></span><span class="token punctuation">;</span>
</code></pre></div><ul><li>string：开启该认证功能，用于配置验证时的指示信息；</li> <li>off：关闭该认证功能；</li></ul> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">auth_basic_user_file</span> file</span><span class="token punctuation">;</span>
</code></pre></div><p>其中，file 为密码文件的绝对路径；</p></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/vuejs/vuepress/edit/master//Nginx/指令及基本介绍.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021-09-29 18:44:24</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Nginx/command.html" class="prev">
        Nginx 常用命令
      </a></span> <span class="next"><a href="/Nginx/正向代理和反向代理.html">
        正向代理、反向代理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.12b19b72.js" defer></script><script src="/assets/js/2.a96faf37.js" defer></script><script src="/assets/js/55.2446979d.js" defer></script>
  </body>
</html>
