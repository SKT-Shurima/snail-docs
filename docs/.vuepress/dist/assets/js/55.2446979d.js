(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{489:function(s,e,t){"use strict";t.r(e);var a=t(25),n=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"nginx-命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-命令"}},[s._v("#")]),s._v(" Nginx 命令：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[s._v("$ nginx -t  // 查看Nginx服务器配置文件是否有语法错误\n")])])]),t("h3",{attrs:{id:"nginx-conf-原始配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-conf-原始配置文件"}},[s._v("#")]),s._v(" Nginx.conf  原始配置文件")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx.conf 原始文件")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ******* 全局块 start ********")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只有被设置的用户组成员才有权限启动Nginx进程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# user nobody")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局生效，配置允许 Nginx 进程生成的 worker_process 数量")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_processes")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置 Nginx 服务器运行对错误日志存放的路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# error_log logs/error.log")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置 Nginx 运行时，pid 文件存放路径和名称；")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pid nginx.pid")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ******* 全局块 end ********")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ******* events start ********")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("events")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置事件驱动模型")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# use epoll;")]),s._v("\n\t\t\n\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在events部分中生效")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_connections")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ******* events end ********")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ******* http start ********")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("http")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n \t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以下指令在http的server部分中生效")]),s._v("\n \t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义 MIME-Type")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v("       mime.types")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   \n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default_type")]),s._v("  application/octet-stream")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置允许使用sendfile 方式传输")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sendfile")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置连接超时时间")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keepalive_timeout")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置请求处理日志的格式")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# log_format access.log \'$remote_addr-[$time_local]-"$request"-"$http_user_agent"\';')]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请求行+请求头的标准大小为1k")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# client_header_buffer_size 1k;")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请求行+请求头的最大大小为2k")]),s._v("\n\t  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# large_client_header_buffers 2 1k;")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ******* server start ********")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置监听端口和主机名称（基于名称）")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v("  localhost")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置请求处理日志存放路径")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# access_log /myweb/server1/log/access.log")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以下指令在http/server 的location 中生效 ")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("   html")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v("  index.html index.htm")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t\t\t "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置错误页面")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_page")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("503")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v("  /50x.html")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" = /50x.html")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("   html")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ******* server end ********")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ******* http end ********")]),s._v("\n")])])]),t("p",[s._v("注意：Nginx 配置文件中，每一条指令配置都必须以分号结束；")]),s._v(" "),t("p",[s._v("结构划分：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("├───nginx.conf\n│   ├───全局块\n│   ├───events\n│   ├───http\n│   │   ├───server\n│   │   │   ├───server 全局块\n│   │   │   ├───location\n│   │   │   ├───location\n")])])]),t("p",[s._v("注意：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("配置文件支持大量可配置的指令，绝大多数指令不是特定属于某一个块的；")])]),s._v(" "),t("li",[t("p",[s._v("同一个指令放在不同层级的块中，其作用域也不同，一般情况下，高一级块中的指令可以作用于自身所在的块和此块包含的所有低层级块；如果某个指令在两个不同层级的块中同时出现，则采用“就近原则”，即较低层级块中的配置为准；")]),s._v(" "),t("p",[t("em",[s._v("（即：高层级块能出现在本级及以下的层级块中，并且以最小层级的配置为准）")])])])]),s._v(" "),t("h4",{attrs:{id:"指令说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#指令说明"}},[s._v("#")]),s._v(" 指令说明")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("user  [user] [group];")]),s._v(" "),t("p",[s._v("只有被设置的用户组成员才有权限启动Nginx进程；")]),s._v(" "),t("p",[s._v("如果希望所有的用户都可以启动Nginx，有两种方案：")]),s._v(" "),t("ul",[t("li",[s._v("注释 "),t("code",[s._v("# user [user] [group]")]),s._v(";")]),s._v(" "),t("li",[s._v("或者将用户（用户组）设置为"),t("code",[s._v("nobody")]),s._v("，"),t("code",[s._v("user nobody nobody")]),s._v(";")])])]),s._v(" "),t("li",[t("p",[s._v("worker process，理论上，值越大可以支持的并发处理量就越多；\n配置允许生成的 worker process 数的指令是 "),t("code",[s._v("worker_processes")])]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[s._v("worker_processes number | auto\n")])])]),t("ul",[t("li",[s._v("number ，指定 Nginx 进程最多可以产生的 worker process 数；")]),s._v(" "),t("li",[s._v("auto， Nginx 进程将自动进行检测；")])]),s._v(" "),t("p",[s._v("注意： 此指令只能在全局块中设置。")])]),s._v(" "),t("li",[t("p",[s._v("Nginx 进程 PID 存放路径")]),s._v(" "),t("p",[s._v("配置文件默认存放在Nginx安装目录logs下，修改语法：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pid")]),s._v(" file")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("file 指定存放路径和文件名称，必须带文件名称；")]),s._v(" "),t("p",[s._v("注意：此指令只能在全局块中使用；")])]),s._v(" "),t("li",[t("p",[s._v("配置错误日志的存放路径")]),s._v(" "),t("p",[s._v("在全局块、http块、sever块中都可以对Nginx服务器的日志进行相关配置；")]),s._v(" "),t("p",[s._v("指令"),t("code",[s._v("error_log")]),s._v("，语法：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_log")]),s._v(" file | stderr [ debug | info | notice | warn | error | crit | alert | emerg ]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("Nginx 服务日志支持输出到某个文件下，或者输出到标准错误输出stderr；")]),s._v(" "),t("p",[s._v("日志等级：")]),s._v(" "),t("ul",[t("li",[s._v("debug  （需要在编译时使用 --with-debug 开启 debug 开关）")]),s._v(" "),t("li",[s._v("info")]),s._v(" "),t("li",[s._v("notice")]),s._v(" "),t("li",[s._v("warn")]),s._v(" "),t("li",[s._v("error")]),s._v(" "),t("li",[s._v("crit")]),s._v(" "),t("li",[s._v("alert")]),s._v(" "),t("li",[s._v("emerg")])]),s._v(" "),t("p",[s._v("注意：设置某一级别，比这一级别高的日志也会被记录；指定文件必须有写的权限；")]),s._v(" "),t("p",[s._v("此指令能在全局块、http、server、location块中使用；")])]),s._v(" "),t("li",[t("p",[s._v("配置文件的引入")]),s._v(" "),t("p",[s._v("Nginx 提供 "),t("code",[s._v("include")]),s._v(" 指令来完成配置文件的引入，语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" file")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("file 是要引入的配置文件，支持相对路径；")]),s._v(" "),t("p",[s._v("注意：引入的文件，必须有写的权限，并且符合Nginx配置文件规定的相关语法和结构；")]),s._v(" "),t("p",[s._v("此指令可以放在配置文件的任意地方；")])]),s._v(" "),t("li",[t("p",[s._v("配置最大连接数")]),s._v(" "),t("p",[s._v("指令worker_connections 主要用来设置允许每一个 worker process 同时开启最大连接数；")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_connections")]),s._v(" number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("注意：number 不仅指和前端用户建立的连接数，而是包括所有可能的连接数；")]),s._v(" "),t("p",[s._v("此指令只能在events中配置，且默认是512；")])]),s._v(" "),t("li",[t("p",[s._v("自定义服务日志")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("access_log")]),s._v(" path [format [buffer=size]]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("取消服务日志功能指令：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("access_log")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("off")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("此指令只能在http块中进行配置；")])]),s._v(" "),t("li",[t("p",[s._v("配置允许sendfile 方式传输文件")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sendfile")]),s._v(" on|off")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("用于开启或关闭使用sendfile()传输文件，默认值是off;")]),s._v(" "),t("p",[s._v("传输文件大小限制，语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sendfile_max_chunk")]),s._v(" size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("size > 0 ，表示Nginx进程的每个worker process 每次调用sendfile() 传输的数据量最大不能超过这个值；")]),s._v(" "),t("p",[s._v("size = 0，表示无限制；")]),s._v(" "),t("p",[s._v("此指令可以在 http、server、location 块中配置；")])]),s._v(" "),t("li",[t("p",[s._v("配置连接超时时间")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keepalive_timeout")]),s._v(" timeout [header_timeout]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("ul",[t("li",[s._v("timeout，服务端对连接得保持时间，默认是75s；")]),s._v(" "),t("li",[s._v("header_timeout，可选项，在应答报文头部的 Keep-Alive 域设置超时时间；")])]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keepalive_timeout")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120s")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100s")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("表达含义是，在服务端保持连接的时间设置为120s，发给用户端的应答报文头部中 Keep-Alive 域的超时时间设置为100s；")]),s._v(" "),t("p",[s._v("此指令可以在http、server、location块中配置；")])]),s._v(" "),t("li",[t("p",[s._v("单连接请求数上限")]),s._v(" "),t("p",[s._v("Nginx服务器和用户端建立会话连接后，用户端通过此连接发送请求，指令keepalive_requests 用于限制用户通过某一连接向Nginx服务器发送请求的次数；默认是100；")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keepalive_requests")]),s._v(" number")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("此指令可以在http、server、location中配置；")])]),s._v(" "),t("li",[t("p",[s._v("client_header_buffer_size、large_client_header_buffers")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("client_header_buffer_size")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1k")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("假设"),t("code",[s._v("client_header_buffer_size")]),s._v("设置为 1k，表示 "),t("em",[s._v("请求行+请求头")]),s._v(" 的大小 < 1k，放行请求，>= 1k，以 "),t("code",[s._v("large_header_buffer_size")]),s._v("为准；")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("large_header_buffer_sizes")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8k")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("假设 "),t("code",[s._v("large_header_buffer_size")]),s._v("的配置为 4 8k，则对请求的要求：")]),s._v(" "),t("ul",[t("li",[s._v("请求行（requests line）的大小不能超过 8k，否则返回 414 错误；")]),s._v(" "),t("li",[s._v("请求头 （requests header）的每一个头部字段的大小不能超过 8k ，否则返回 404 错误\n"),t("code",[s._v('curl -H "header1=aaa" -H "header2=bbb" -v http://127.0.0.1/')]),s._v("，这里的 header1=aaa 和 header2=bbb 就是请求头中的头部字段")]),s._v(" "),t("li",[t("em",[s._v("请求头+请求行")]),s._v(" 的大小不能超过 32K (4*8k)；")])])]),s._v(" "),t("li",[t("p",[s._v("基于名称的虚拟主机配置")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" name ...")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("name：可以只有一个名称，也可以多个并列，之间用空格隔开；每个名字就是个域名，有两段或三段组成，之间由“.” 隔开；")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" myserver.com www.myserver.com")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("第一个名称作为虚拟主机的主要名称；")]),s._v(" "),t("p",[t("code",[s._v("server_name")]),s._v(" 匹配规则优先级顺序：")]),s._v(" "),t("ol",[t("li",[s._v("准确匹配"),t("code",[s._v("server_name")]),s._v(" ，如："),t("code",[s._v("server_name www.myserver.com")]),s._v("；")]),s._v(" "),t("li",[s._v("通配符在开始时匹配"),t("code",[s._v("server_name")]),s._v("成功，如："),t("code",[s._v("server_name *.myserver.com")]),s._v("；")]),s._v(" "),t("li",[s._v("通配符在结束时匹配"),t("code",[s._v("server_name")]),s._v("成功，如："),t("code",[s._v("server_name www.myserver.*")]),s._v("；")]),s._v(" "),t("li",[s._v("正则表达式匹配"),t("code",[s._v("server_name")]),s._v("成功，如："),t("code",[s._v("server_name ~^www\\d+\\.myserver.\\com$")]),s._v("；"),t("em",[s._v("（ps：正则表达式用“~”标记）")])])]),s._v(" "),t("p",[s._v("注意："),t("code",[s._v("server_name")]),s._v("处于统一优先级的匹配方式多次成功，则首次匹配成功的虚拟机处理请求；")])]),s._v(" "),t("li",[t("p",[s._v("location")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v("  [ = | ~ | ~* | ^~ ] uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("..."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("ul",[t("li",[s._v("=  ： 表示严格匹配；")]),s._v(" "),t("li",[s._v("~  ：用于表示 uri 包含的正则表达式，并区分大小写；")]),s._v(" "),t("li",[s._v("~*  ：用于表示 uri 包含的正则表达式，并不区分大小写；")])])]),s._v(" "),t("li",[t("p",[s._v("配置请求根目录")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v(" path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("更改 location 的 URI")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alias")]),s._v(" path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("设置网站的默认首页")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" file ...")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("其中 file 变量可以包括多个文件名，其他使用空格分隔，也可以包含其他变量；")]),s._v(" "),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" ~^/data/(.+)/web$")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tindex index.$1.html  index.my01.html index.html\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("其中 "),t("code",[s._v("~")]),s._v(" 开头的表示正则匹配，"),t("code",[s._v("(.+)")]),s._v(' 表示变量，即当接收到 "/data/locationtest/web/"时，会依次匹配 /data/locationtest/web/ 路径下的 index.locationtest.html、index.my01.html、index.html 页面；')])]),s._v(" "),t("li",[t("p",[s._v("设置网站的错误页面  "),t("RouterLink",{attrs:{to:"/HTTP/常见错误码.html"}},[s._v("HTTP 常见错误码")])],1),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_page")]),s._v(" code ... [=[response]] uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("ul",[t("li",[s._v("code ：要处理的HTTP 错误码；")]),s._v(" "),t("li",[s._v("response：可选，将 code 指定的错误码转换为新的错误代码 response；")]),s._v(" "),t("li",[s._v("uri：错误页面的路径或者网站地址，可以是相对路径（相对Nginx安装路径下的html目录为根路径的相对路径），可以说是网址；")])])]),s._v(" "),t("li",[t("p",[s._v("基于 IP 配置 Nginx 的访问权限")]),s._v(" "),t("p",[s._v("允许指令：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("allow")]),s._v(" address | CIDR | all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("ul",[t("li",[s._v("address：允许访问客户端的 IP ，不支持同事设置多个，如果需要设置多个需要重复使用 allow；")]),s._v(" "),t("li",[s._v("CIDR：允许访问的客户端的 CIDR 地址；")]),s._v(" "),t("li",[s._v("all：代表允许所有客户端访问；")])]),s._v(" "),t("p",[s._v("禁止访问指令：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("deny")]),s._v(" address | CIDR | all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("此指令可以在http、server、location中配置；")])]),s._v(" "),t("li",[t("p",[s._v("基于密码配置 Nginx 的访问权限")]),s._v(" "),t("p",[s._v("语法结构：")]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("auth_basic")]),s._v("  string | "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("off")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("ul",[t("li",[s._v("string：开启该认证功能，用于配置验证时的指示信息；")]),s._v(" "),t("li",[s._v("off：关闭该认证功能；")])]),s._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("auth_basic_user_file")]),s._v(" file")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("其中，file 为密码文件的绝对路径；")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);